define("discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-adapter",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{basePath(){return"/discourse-reactions/"}}e.default=s})),define("discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-custom-reaction",["exports","discourse/plugins/discourse-reactions/discourse/adapters/discourse-reactions-adapter"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{pathFor(e,t,s){const i=this.basePath(e,t,s)+e.pluralize(this.apiNameFor(t))
return this.appendQueryParams(i,s)}apiNameFor(){return"custom-reaction"}}e.default=s})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button",["exports","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,s.setComponentTemplate)((0,i.createTemplateFactory)({id:"ad0fsyB/",block:'[[[1,"\\n  "],[10,0],[14,0,"discourse-reactions-actions-button-shim"],[12],[1,"\\n    "],[8,[32,0],null,[["@post","@showLogin"],[[30,1],[30,2,["showLogin"]]]],null],[1,"\\n  "],[13],[1,"\\n"]],["@post","@buttonActions"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button.js",scope:()=>[t.default],isStrictMode:!0}),(0,o.default)(void 0,"discourse-reactions-actions-button:ReactionsActionButton"))
e.default=r})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary",["exports","@glimmer/component","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","@ember/component","@ember/template-factory"],(function(e,t,s,i,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static extraControls=!0
static shouldRender(e,t,s){if(s.lookup("service:site").mobileView||e.post.deleted)return!1
const i=s.lookup("service:site-settings").discourse_reactions_reaction_for_like
return!(e.post.reactions&&1===e.post.reactions.length&&e.post.reactions[0].id===i)}static#e=(()=>(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"XfiSbGxc",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[12],[1,"\\n        "],[8,[32,0],null,[["@post","@position"],[[30,2],"left"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@shouldRender","@post"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary.js",scope:()=>[s.default],isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/runloop","@ember/service","@popperjs/core","ember-curry-component","jquery","rsvp","truth-helpers","discourse/helpers/lazy-hash","discourse/lib/environment","discourse/lib/text","discourse/modifiers/close-on-click-outside","discourse-i18n","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d,p,h,m,g,_,f,b,y,v,k,x,P,S){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.resetCurrentReaction=function(){U=null}
let j,U
function w(e,t,s,i,o){if((0,m.isTesting)())return
const r=function(e){const t=document.createElement("img")
return t.src=(0,g.emojiUrlFor)(e),t.classList.add("btn-toggle-reaction-emoji","reaction-button","fake-reaction"),t}(t)
e.querySelector(".reaction-button").appendChild(r)
r.style.top=s,r.style.opacity=0,(0,l.default)(r).animate({top:i,opacity:1},{duration:350,complete:()=>{r.remove(),o()}},"swing")}function E(e,t,s,i){return(0,m.isTesting)()?(0,n.run)(this,i):(0,l.default)(e).stop().css("textIndent",t).animate({textIndent:s},{complete:i,step(e){(0,l.default)(this).css("transform",`scale(${e})`).addClass("far-heart").removeClass("heart")},duration:150},"linear")}class C extends t.default{static#e=(()=>dt7948.g(this.prototype,"dialog",[c.service]))()
#t=(()=>{dt7948.i(this,"dialog")})()
static#s=(()=>dt7948.g(this.prototype,"capabilities",[c.service]))()
#i=(()=>{dt7948.i(this,"capabilities")})()
static#o=(()=>dt7948.g(this.prototype,"siteSettings",[c.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
static#n=(()=>dt7948.g(this.prototype,"site",[c.service]))()
#c=(()=>{dt7948.i(this,"site")})()
static#a=(()=>dt7948.g(this.prototype,"currentUser",[c.service]))()
#u=(()=>{dt7948.i(this,"currentUser")})()
static#l=(()=>dt7948.g(this.prototype,"reactionsPickerExpanded",[s.tracked],(function(){return!1})))()
#d=(()=>{dt7948.i(this,"reactionsPickerExpanded")})()
static#p=(()=>dt7948.g(this.prototype,"statePanelExpanded",[s.tracked],(function(){return!1})))()
#h=(()=>{dt7948.i(this,"statePanelExpanded")})()
get classes(){const{post:e}=this.args
if(!e.reactions)return
const t=e.reactions.length,s=e.current_user_reaction,i=[]
return e.reactions.length&&e.reactions.filter((e=>e.id!==this.siteSettings.discourse_reactions_reaction_for_like)).length&&i.push("custom-reaction-used"),e.yours&&i.push("my-post"),t&&i.push("has-reactions"),s&&i.push("has-reacted"),e.current_user_used_main_reaction&&i.push("has-used-main-reaction"),e.current_user_reaction&&!e.current_user_reaction.can_undo||!e.likeAction?.canToggle||i.push("can-toggle-reaction"),i.join(" ")}toggleReactions(e){this.reactionsPickerExpanded||(this.statePanelExpanded?this.scheduleExpand("expandReactionsPicker"):this.expandReactionsPicker(e))}static#m=(()=>dt7948.n(this.prototype,"toggleReactions",[r.action]))()
touchStart(){if(this._validTouch=!0,(0,n.cancel)(this._touchTimeout),this.capabilities.touch)return document.documentElement?.classList?.toggle("discourse-reactions-no-select",!0),this._touchStartAt=Date.now(),this._touchTimeout=(0,n.later)((()=>{this._touchStartAt=null,this.toggleReactions()}),400),!1}static#g=(()=>dt7948.n(this.prototype,"touchStart",[r.action]))()
touchMove(){this._validTouch=!1,(0,n.cancel)(this._touchTimeout)}static#_=(()=>dt7948.n(this.prototype,"touchMove",[r.action]))()
touchEnd(e){if((0,n.cancel)(this._touchTimeout),this._validTouch&&this.capabilities.touch){if(e.changedTouches.length){const t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY)
if(t){const e=t.parentNode
if(t.classList.contains("pickable-reaction"))return void t.click()
if(e&&e.classList.contains("pickable-reaction"))return void e.click()}}const t=Date.now()-(this._touchStartAt||0)
this._touchStartAt=null,t>400?e&&e.target&&e.target.classList.contains("discourse-reactions-reaction-button")&&this.toggleReactions(e):e.target&&(e.target.classList.contains("discourse-reactions-reaction-button")||e.target.classList.contains("reaction-button"))&&this.toggleFromButton({reaction:this.args.post.current_user_reaction?this.args.post.current_user_reaction.id:this.siteSettings.discourse_reactions_reaction_for_like})}}static#f=(()=>dt7948.n(this.prototype,"touchEnd",[r.action]))()
toggle(e){if(this.currentUser||!this.args.showLogin){if(!this.args.post.current_user_reaction||this.args.post.current_user_reaction.can_undo&&this.args.post.likeAction.canToggle){this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5)
const t=document.querySelector(`[data-post-id="${e.postId}"] .discourse-reactions-picker .pickable-reaction.${CSS.escape(e.reaction)} .emoji`),s=[1,1.75]
return new d.Promise((i=>{E(t,s[0],s[1],(()=>{E(t,s[1],s[0],(()=>{const t=this.args.post,s=document.querySelector(`[data-post-id="${e.postId}"]`)
var o,r
t.current_user_reaction&&t.current_user_reaction.id===e.reaction?(this.toggleReaction(e),(0,n.later)((()=>{var o,r
o=s,r=e.reaction,w(o,r,"8px","42px",(()=>b.default.toggle(this.args.post,e.reaction).then(i).catch((e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(t)}))))}),100)):(o=s,r=e.reaction,w(o,r,"-50px","8px",(()=>{this.toggleReaction(e),b.default.toggle(this.args.post,e.reaction).then(i).catch((e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(t)}))})))}))}))})).finally((()=>{this.collapseAllPanels()}))}}else this.args.showLogin()}static#b=(()=>dt7948.n(this.prototype,"toggle",[r.action]))()
toggleReaction(e){if(this.collapseAllPanels(),this.args.post.current_user_reaction&&!this.args.post.current_user_reaction.can_undo&&!this.args.post.likeAction.canToggle)return
const t=this.args.post
if(t.current_user_reaction&&t.reactions.every(((e,s)=>e.count<=1&&e.id===t.current_user_reaction.id?(t.reactions.splice(s,1),!1):e.id!==t.current_user_reaction.id||(t.reactions[s].count-=1,!1))),!e.reaction||t.current_user_reaction&&e.reaction===t.current_user_reaction.id)t.reaction_users_count-=1,t.current_user_reaction=null
else{let s=!1
if(t.reactions.every(((i,o)=>i.id!==e.reaction||(t.reactions[o].count+=1,s=!0,!1))),!s){const s={id:e.reaction,type:"emoji",count:1},i=Object.assign([],t.reactions)
i.push(s)
const o=i.sort(((e,t)=>e.count>t.count?-1:e.count<t.count||e.id>t.id?1:e.id<t.id?-1:void 0)).indexOf(s)
t.reactions.splice(o,0,s)}t.current_user_reaction||(t.reaction_users_count+=1),t.current_user_reaction={id:e.reaction,type:"emoji",can_undo:!0}}t.current_user_reaction&&t.current_user_reaction.id===this.siteSettings.discourse_reactions_reaction_for_like?t.current_user_used_main_reaction=!0:t.current_user_used_main_reaction=!1,t.reactions=t.reactions}toggleFromButton(e){if(!this.currentUser&&this.args.showLogin)return void this.args.showLogin()
this.collapseAllPanels()
const t=this.siteSettings.discourse_reactions_reaction_for_like,s=this.args.post,i=s.current_user_reaction
if(s.likeAction&&!s.likeAction.canToggle&&!s.likeAction.can_undo)return
if(this.args.post.current_user_reaction&&!this.args.post.current_user_reaction.can_undo)return
if(!this.currentUser||s.user_id===this.currentUser.id)return
if(this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5),i&&i.id===e.reaction)return this.toggleReaction(e),b.default.toggle(this.args.post,e.reaction).catch((e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(s)}))
let o
o=s.reactions&&1===s.reactions.length&&s.reactions[0].id===t?`[data-post-id="${this.args.post.id}"] .discourse-reactions-double-button .discourse-reactions-reaction-button .d-icon`:e.reaction&&e.reaction!==t?`[data-post-id="${this.args.post.id}"] .discourse-reactions-reaction-button .reaction-button .btn-toggle-reaction-emoji`:`[data-post-id="${this.args.post.id}"] .discourse-reactions-reaction-button .d-icon`
const r=document.querySelector(o),n=[1,1.5]
return new d.Promise((i=>{E(r,n[0],n[1],(()=>{E(r,n[1],n[0],(()=>{this.toggleReaction(e)
let o=e.reaction&&e.reaction!==t?e.reaction:this.siteSettings.discourse_reactions_reaction_for_like
b.default.toggle(this.args.post,o).then(i).catch((e=>{this.dialog.alert(this._extractErrors(e)),this._rollbackState(s)}))}))}))}))}static#y=(()=>dt7948.n(this.prototype,"toggleFromButton",[r.action]))()
cancelCollapse(){(0,n.cancel)(this._collapseHandler)}static#v=(()=>dt7948.n(this.prototype,"cancelCollapse",[r.action]))()
cancelExpand(){(0,n.cancel)(this._expandHandler)}static#k=(()=>dt7948.n(this.prototype,"cancelExpand",[r.action]))()
scheduleExpand(e){this.cancelExpand(),this._expandHandler=(0,n.later)(this,this[e],250)}scheduleCollapse(e){this.cancelCollapse(),this._collapseHandler=(0,n.later)(this,this[e],500)}static#x=(()=>dt7948.n(this.prototype,"scheduleCollapse",[r.action]))()
get elementId(){return`discourse-reactions-actions-${this.args.post.id}-${this.args.position||"right"}`}clickOutside(){(this.reactionsPickerExpanded||this.statePanelExpanded)&&this.collapseAllPanels()}static#P=(()=>dt7948.n(this.prototype,"clickOutside",[r.action]))()
expandReactionsPicker(){(0,n.cancel)(this._collapseHandler),U?.collapseAllPanels(),this.statePanelExpanded=!1,this.reactionsPickerExpanded=!0,this._setupPopper([".discourse-reactions-reaction-button",".discourse-reactions-picker"])}expandStatePanel(){(0,n.cancel)(this._collapseHandler),U?.collapseAllPanels(),this.statePanelExpanded=!0,this.reactionsPickerExpanded=!1,this._setupPopper([".discourse-reactions-counter",".discourse-reactions-state-panel"])}static#S=(()=>dt7948.n(this.prototype,"expandStatePanel",[r.action]))()
collapseStatePanel(){(0,n.cancel)(this._collapseHandler),this._collapseHandler=null,this.statePanelExpanded=!1}static#j=(()=>dt7948.n(this.prototype,"collapseStatePanel",[r.action]))()
collapseReactionsPicker(){(0,n.cancel)(this._collapseHandler),this._collapseHandler=null,this.reactionsPickerExpanded=!1}collapseAllPanels(){(0,n.cancel)(this._collapseHandler),document.documentElement?.classList?.toggle("discourse-reactions-no-select",!1),this._collapseHandler=null,this.statePanelExpanded=!1,this.reactionsPickerExpanded=!1}static#U=(()=>dt7948.n(this.prototype,"collapseAllPanels",[r.action]))()
updatePopperPosition(){j?.update()}static#w=(()=>dt7948.n(this.prototype,"updatePopperPosition",[r.action]))()
_setupPopper(e){(0,n.schedule)("afterRender",(()=>{const t=this.args.position||"right",s=this.args.post.id,i=document.querySelector(`#discourse-reactions-actions-${s}-${t} ${e[0]}`),o=document.querySelector(`#discourse-reactions-actions-${s}-${t} ${e[1]}`)
j?.destroy(),j=this._applyPopper(i,o),U=this}))}_applyPopper(e,t){return(0,a.createPopper)(e,t,{placement:"top",modifiers:[{name:"offset",options:{offset:[0,-5]}},{name:"preventOverflow",options:{padding:5}}]})}_rollbackState(e){const t=e.current_user_reaction,s=e.current_user_used_main_reaction,i=Object.assign([],e.reactions),o=e.reaction_users_count
e.current_user_reaction=t,e.current_user_used_main_reaction=s,e.reactions=i,e.reaction_users_count=o}_extractErrors(e){const t=e.xhr||e.jqXHR
return t&&t.status?429===t.status&&t.responseJSON&&t.responseJSON.errors&&t.responseJSON.errors[0]?t.responseJSON.errors[0]:403===t.status?(0,f.i18n)("discourse_reactions.reaction.forbidden"):(0,f.i18n)("errors.desc.unknown"):(0,f.i18n)("errors.desc.network")}get onlyOneMainReaction(){return 1===this.args.post.reactions?.length&&this.args.post.reactions[0].id===this.siteSettings.discourse_reactions_reaction_for_like}get showReactionsPicker(){return this.currentUser&&this.args.post.user_id!==this.currentUser.id&&this.reactionsPickerExpanded}static#E=(()=>(0,P.setComponentTemplate)((0,S.createTemplateFactory)({id:"bx9MgSQ5",block:'[[[1,"\\n    "],[11,0],[16,1,[30,0,["elementId"]]],[16,0,[29,["discourse-reactions-actions ",[30,0,["classes"]]]]],[4,[32,0],["touchstart",[30,0,["touchStart"]]],null],[4,[32,0],["touchmove",[30,0,["touchMove"]]],null],[4,[32,0],["touchend",[30,0,["touchEnd"]]],null],[4,[32,1],[[30,0,["clickOutside"]],[28,[32,2],null,null]],null],[12],[1,"\\n"],[44,[[28,[32,2],null,[["counter","button"],[[28,[32,3],[[32,4],[28,[32,5],null,[["post","position","reactionsPickerExpanded","statePanelExpanded","expandStatePanel","collapseStatePanel","cancelCollapse","scheduleCollapse","updatePopperPosition","collapseAllPanels"],[[30,1],[30,2],[30,0,["reactionsPickerExpanded"]],[30,0,["statePanelExpanded"]],[30,0,["expandStatePanel"]],[30,0,["collapseStatePanel"]],[30,0,["cancelCollapse"]],[30,0,["scheduleCollapse"]],[30,0,["updatePopperPosition"]],[30,0,["collapseAllPanels"]]]]]],null],[28,[32,3],[[32,6],[28,[32,5],null,[["post","position","cancelCollapse","toggleFromButton","toggleReactions","cancelExpand","scheduleCollapse"],[[30,1],[30,2],[30,0,["cancelCollapse"]],[30,0,["toggleFromButton"]],[30,0,["toggleReactions"]],[30,0,["cancelExpand"]],[30,0,["scheduleCollapse"]]]]]],null]]]]],[[[41,[30,0,["showReactionsPicker"]],[[[1,"          "],[8,[32,7],null,[["@post","@scheduleCollapse","@cancelCollapse","@reactionsPickerExpanded","@toggle"],[[30,1],[30,0,["scheduleCollapse"]],[30,0,["cancelCollapse"]],[30,0,["reactionsPickerExpanded"]],[30,0,["toggle"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,8],[[30,2],"left"],null],[[[1,"          "],[8,[30,3,["counter"]],null,null,null],[1,"\\n"]],[]],[[[41,[30,0,["onlyOneMainReaction"]],[[[1,"          "],[8,[32,9],null,[["@post","@counterComponent","@buttonComponent"],[[30,1],[30,3,["counter"]],[30,3,["button"]]]],null],[1,"\\n"]],[]],[[[41,[30,0,["site","mobileView"]],[[[41,[28,[32,10],[[30,1,["yours"]]],null],[[[1,"            "],[8,[30,3,["counter"]],null,null,null],[1,"\\n            "],[8,[30,3,["button"]],null,null,null],[1,"\\n"]],[]],[[[41,[28,[32,11],[[30,1,["yours"]],[30,1,["reactions"]],[30,1,["reactions","length"]]],null],[[[1,"            "],[8,[30,3,["counter"]],null,null,null],[1,"\\n          "]],[]],null]],[]]]],[]],[[[41,[28,[32,10],[[30,1,["yours"]]],null],[[[1,"          "],[8,[30,3,["button"]],null,null,null],[1,"\\n        "]],[]],null]],[]]]],[]]]],[]]]],[3]]],[1,"    "],[13],[1,"\\n  "]],["@post","@position","components"],false,["let","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions.js",scope:()=>[o.on,_.default,i.hash,u.default,y.default,h.default,x.default,k.default,p.eq,v.default,p.not,p.and],isStrictMode:!0}),this))()}e.default=C})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","@ember-compat/tracked-built-ins","truth-helpers","discourse/helpers/d-icon","discourse/lib/decorators","discourse/modifiers/close-on-click-outside","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d,p,h,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static#e=(()=>dt7948.g(this.prototype,"capabilities",[r.service]))()
#i=(()=>{dt7948.i(this,"capabilities")})()
static#s=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#c=(()=>{dt7948.i(this,"site")})()
static#o=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
reactionsUsers=(()=>new n.TrackedObject)()
get elementId(){return`discourse-reactions-counter-${this.args.post.id}-${this.args.position||"right"}`}reactionsChanged(e){e.reactions.uniq().forEach((e=>{this.getUsers(e)}))}getUsers(e){return d.default.findReactionUsers(this.args.post.id,{reactionValue:e}).then((e=>{e.reaction_users.forEach((e=>{this.reactionsUsers[e.id]=e.users})),this.args.updatePopperPosition()}))}static#n=(()=>dt7948.n(this.prototype,"getUsers",[u.bind]))()
mouseDown(e){return e.stopImmediatePropagation(),!1}static#a=(()=>dt7948.n(this.prototype,"mouseDown",[o.action]))()
mouseUp(e){return e.stopImmediatePropagation(),!1}static#l=(()=>dt7948.n(this.prototype,"mouseUp",[o.action]))()
click(e){this.args.cancelCollapse(),this.capabilities.touch&&this.site.mobileView||(e.stopPropagation(),e.preventDefault(),this.args.statePanelExpanded||this.getUsers(),this.toggleStatePanel(e))}static#p=(()=>dt7948.n(this.prototype,"click",[o.action]))()
clickOutside(){this.args.statePanelExpanded&&this.args.collapseAllPanels()}static#m=(()=>dt7948.n(this.prototype,"clickOutside",[o.action]))()
touchStart(e){return this.args.cancelCollapse(),!(!e.target.classList.contains("show-users")&&!e.target.classList.contains("avatar"))||(this.args.statePanelExpanded?(e.stopPropagation(),void e.preventDefault()):void(this.capabilities.touch&&(e.stopPropagation(),e.preventDefault(),this.getUsers(),this.toggleStatePanel(e))))}static#g=(()=>dt7948.n(this.prototype,"touchStart",[o.action]))()
get classes(){const e=[],t=this.siteSettings.discourse_reactions_reaction_for_like,{post:s}=this.args
return s.reactions&&1===s.reactions.length&&s.reactions[0].id===t&&e.push("only-like"),s.reaction_users_count>0&&e.push("discourse-reactions-counter"),e.join(" ")}toggleStatePanel(){this.args.statePanelExpanded?this.args.collapseStatePanel():this.args.expandStatePanel()}pointerOver(e){"mouse"===e.pointerType&&this.args.cancelCollapse()}static#_=(()=>dt7948.n(this.prototype,"pointerOver",[o.action]))()
pointerOut(e){"mouse"===e.pointerType&&(e.relatedTarget?.closest(`#${this.elementId}`)||this.args.scheduleCollapse("collapseStatePanel"))}static#f=(()=>dt7948.n(this.prototype,"pointerOut",[o.action]))()
get onlyOneMainReaction(){return 1===this.args.post.reactions?.length&&this.args.post.reactions[0].id===this.siteSettings.discourse_reactions_reaction_for_like}static#b=(()=>(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"H/jX433S",block:'[[[1,"\\n"],[1,"    "],[11,0],[16,1,[30,0,["elementId"]]],[16,0,[30,0,["classes"]]],[4,[32,0],["mousedown",[30,0,["mouseDown"]]],null],[4,[32,0],["mouseup",[30,0,["mouseUp"]]],null],[4,[32,1],[[30,0,["clickOutside"]],[28,[32,2],null,null]],null],[4,[32,0],["touchstart",[30,0,["touchStart"]]],null],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,0],["pointerout",[30,0,["pointerOut"]]],null],[4,[32,0],["click",[30,0,["click"]]],null],[12],[1,"\\n"],[41,[30,1,["reaction_users_count"]],[[[1,"        "],[8,[32,3],null,[["@post","@reactionsUsers","@statePanelExpanded","@scheduleCollapse","@cancelCollapse"],[[30,1],[30,0,["reactionsUsers"]],[30,2],[30,3],[30,4]]],null],[1,"\\n\\n"],[41,[51,[30,0,["onlyOneMainReaction"]]],[[[1,"          "],[8,[32,4],[[4,[32,0],["click",[30,0,["click"]]],null]],[["@post","@reactionsUsers","@getUsers"],[[30,1],[30,0,["reactionsUsers"]],[30,0,["getUsers"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[10,1],[14,0,"reactions-counter"],[12],[1,"\\n          "],[1,[30,1,["reaction_users_count"]]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[28,[32,5],[[30,1,["yours"]],[30,0,["onlyOneMainReaction"]]],null],[[[1,"          "],[10,0],[14,0,"discourse-reactions-reaction-button my-likes"],[12],[1,"\\n            "],[10,"button"],[14,0,"btn-toggle-reaction-like btn-icon no-text reaction-button"],[14,4,"button"],[12],[1,"\\n              "],[1,[28,[32,6],[[30,0,["siteSettings","discourse_reactions_like_icon"]]],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@post","@statePanelExpanded","@scheduleCollapse","@cancelCollapse"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-counter.js",scope:()=>[i.on,l.default,s.hash,h.default,p.default,c.and,a.default],isStrictMode:!0}),this))()}e.default=_})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"nekTOUxT",block:'[[[1,"\\n  "],[10,0],[14,0,"discourse-reactions-double-button"],[12],[1,"\\n"],[41,[30,1,["reaction_users_count"]],[[[1,"      "],[8,[30,2],null,null,null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[51,[30,1,["yours"]]],[[[1,"      "],[8,[30,3],null,null,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["@post","@counterComponent","@buttonComponent"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-double-button.js",isStrictMode:!0}),(0,i.default)(void 0,"discourse-reactions-double-button:DiscourseReactionsDoubleButton"))
e.default=o})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/runloop","@ember/service","@popperjs/core","discourse/helpers/emoji","discourse/lib/decorators","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let h
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"loadingReactions",[s.tracked],(function(){return!1})))()
#C=(()=>{dt7948.i(this,"loadingReactions")})()
get elementId(){return`discourse-reactions-list-emoji-${this.args.post.id}-${this.args.reaction.id}`}pointerOver(e){"mouse"===e.pointerType&&(this._setupPopper(".user-list"),this.args.users?.length||this.loadingReactions||(0,r.debounce)(this,this._loadReactionUsers,3e3,!0))}static#o=(()=>dt7948.n(this.prototype,"pointerOver",[o.action]))()
_setupPopper(e){(0,r.schedule)("afterRender",(()=>{const t=CSS.escape(this.elementId),s=document.querySelector(`#${t}`),i=document.querySelector(`#${t} ${e}`)
i&&(h&&h.destroy(),h=(0,c.createPopper)(s,i,{placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,-5]}},{name:"preventOverflow",options:{padding:5}}]}))}))}_loadReactionUsers(){this.loadingReactions=!0,this.args.getUsers(this.args.reaction.id).finally((()=>{this.loadingReactions=!1}))}get truncatedUsers(){return this.args.users?.slice(0,19)}displayNameForUser(e){return!this.siteSettings.prioritize_username_in_ux&&this.siteSettings.prioritize_full_name_in_ux?e.name||e.username:this.siteSettings.prioritize_username_in_ux?e.username:e.name?e.name:e.username}static#n=(()=>dt7948.n(this.prototype,"displayNameForUser",[u.bind]))()
get hiddenUserCount(){return this.args.users?.length-this.truncatedUsers?.length}static#a=(()=>(0,d.setComponentTemplate)((0,p.createTemplateFactory)({id:"ZxUliyq9",block:'[[[1,"\\n    "],[11,0],[24,0,"discourse-reactions-list-emoji"],[16,1,[30,0,["elementId"]]],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[12],[1,"\\n"],[41,[30,1,["count"]],[[[1,"        "],[1,[28,[32,1],[[30,1,["id"]]],[["skipTitle","class"],[true,[52,[30,0,["siteSettings","discourse_reactions_desaturated_reaction_panel"]],"desaturated",""]]]]],[1,"\\n\\n        "],[10,0],[14,0,"user-list"],[12],[1,"\\n          "],[10,0],[14,0,"container"],[12],[1,"\\n            "],[10,1],[14,0,"heading"],[12],[1,[30,1,["id"]]],[13],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["truncatedUsers"]]],null]],null],null,[[[1,"              "],[10,1],[14,0,"username"],[12],[1,[28,[30,0,["displayNameForUser"]],[[30,2]],null]],[13],[1,"\\n"]],[2]],[[[1,"              "],[10,0],[14,0,"center"],[12],[10,0],[14,0,"spinner small"],[12],[13],[13],[1,"\\n"]],[]]],[41,[30,0,["hiddenUserCount"]],[[[1,"              "],[10,1],[14,0,"other-users"],[12],[1,"\\n                "],[1,[28,[32,2],["discourse_reactions.state_panel.more_users"],[["count"],[[30,0,["hiddenUserCount"]]]]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@reaction","user"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji.js",scope:()=>[i.on,a.default,l.i18n],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list",["exports","@ember/helper","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list-emoji","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,i.setComponentTemplate)((0,o.createTemplateFactory)({id:"2bJj0iXp",block:'[[[1,"\\n  "],[11,0],[24,0,"discourse-reactions-list"],[17,1],[12],[1,"\\n"],[41,[30,2,["reaction_users_count"]],[[[1,"      "],[10,0],[14,0,"reactions"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["reactions"]]],null]],null],null,[[[1,"          "],[8,[32,0],null,[["@reaction","@users","@post","@getUsers"],[[30,3],[28,[32,1],[[30,4],[30,3,["id"]]],null],[30,2],[30,5]]],null],[1,"\\n"]],[3]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["&attrs","@post","reaction","@reactionsUsers","@getUsers"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-list.js",scope:()=>[s.default,t.get],isStrictMode:!0}),(0,r.default)(void 0,"discourse-reactions-list:DiscourseReactionsList"))
e.default=n})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","discourse/components/d-button","discourse/helpers/concat-class","discourse/helpers/emoji","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
pointerOut(e){"mouse"===e.pointerType&&this.args.scheduleCollapse("collapseReactionsPicker")}static#s=(()=>dt7948.n(this.prototype,"pointerOut",[o.action]))()
pointerOver(){"mouse"===event.pointerType&&this.args.cancelCollapse()}static#o=(()=>dt7948.n(this.prototype,"pointerOver",[o.action]))()
get reactionInfo(){const e=this.siteSettings.discourse_reactions_enabled_reactions.split("|").filter(Boolean)
e.includes(this.siteSettings.discourse_reactions_reaction_for_like)||e.unshift(this.siteSettings.discourse_reactions_reaction_for_like)
const{post:t}=this.args,s=t.current_user_reaction
return e.map((e=>{let i,o,r,n
return i=e===this.siteSettings.discourse_reactions_reaction_for_like?t.current_user_used_main_reaction:s&&s.id===e,o=s?s.can_undo&&t.likeAction.canToggle:t.likeAction.canToggle,o?(r="discourse_reactions.picker.react_with",n={reaction:e}):r="discourse_reactions.picker.cant_remove_reaction",{id:e,title:(0,u.i18n)(r,n),canUndo:o,isUsed:i}}))}_getOptimalColsCount(e){let t
const s=[5,6,7,8]
if(e<s[0])return e
for(let i=0;i<s.length;++i){const o=s[i]
let r=e%o
if(0===r){t=o
break}(0===i||r>e%(o-1))&&(t=o)}return t}static#n=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"gYUvm26U",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["discourse-reactions-picker",[52,[30,1],"is-expanded"]],null]],[4,[32,1],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,1],["pointerout",[30,0,["pointerOut"]]],null],[12],[1,"\\n"],[41,[30,1],[[[1,"        "],[10,0],[15,0,[29,["discourse-reactions-picker-container col-",[28,[30,0,["_getOptimalColsCount"]],[[30,0,["reactionInfo","length"]]],null]]]],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["reactionInfo"]]],null]],null],null,[[[1,"            "],[8,[32,2],[[16,0,[28,[32,0],["pickable-reaction",[30,2,["id"]],[52,[30,2,["canUndo"]],"can-undo"],[52,[30,2,["isUsed"]],"is-used"]],null]],[16,"data-reaction",[30,2,["id"]]]],[["@action","@translatedTitle"],[[28,[32,3],[[30,3],[28,[32,4],null,[["reaction","postId","canUndo"],[[30,2,["id"]],[30,4,["id"]],[30,2,["canUndo"]]]]]],null],[30,2,["title"]]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,5],[[30,2,["id"]]],null]],[1,"\\n            "]],[]]]]],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@reactionsPickerExpanded","reaction","@toggle","@post"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-picker.js",scope:()=>[c.default,i.on,n.default,s.fn,s.hash,a.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","@ember/utils","discourse/helpers/d-icon","discourse/lib/text","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"capabilities",[r.service]))()
#i=(()=>{dt7948.i(this,"capabilities")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
static#o=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#c=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[r.service]))()
#u=(()=>{dt7948.i(this,"currentUser")})()
click(){this.args.cancelCollapse()
const e=this.args.post.current_user_reaction
this.capabilities.touch&&this.site.mobileView||this.args.toggleFromButton({reaction:e?e.id:this.siteSettings.discourse_reactions_reaction_for_like})}static#a=(()=>dt7948.n(this.prototype,"click",[o.action]))()
pointerOver(e){if("mouse"!==e.pointerType)return
this.args.cancelCollapse()
const t=this.args.post.likeAction,s=this.args.post.current_user_reaction;(!s||s.can_undo||t&&!(0,n.isBlank)(t.can_undo))&&this.args.toggleReactions(e)}static#l=(()=>dt7948.n(this.prototype,"pointerOver",[o.action]))()
pointerOut(e){"mouse"===e.pointerType&&(this.args.cancelExpand(),this.args.scheduleCollapse("collapseReactionsPicker"))}static#p=(()=>dt7948.n(this.prototype,"pointerOut",[o.action]))()
get title(){if(!this.currentUser)return(0,u.i18n)("discourse_reactions.main_reaction.unauthenticated")
const e=this.args.post.likeAction
if(!e)return null
let t,s
const i=this.args.post.current_user_reaction
return e.canToggle&&(0,n.isBlank)(e.can_undo)&&(t="discourse_reactions.main_reaction.add"),e.canToggle&&e.can_undo&&(t="discourse_reactions.main_reaction.remove"),e.canToggle||(t="discourse_reactions.main_reaction.cant_remove"),i&&i.can_undo&&(0,n.isBlank)(e.can_undo)&&(t="discourse_reactions.picker.remove_reaction",s={reaction:i.id}),i&&!i.can_undo&&(0,n.isBlank)(e.can_undo)&&(t="discourse_reactions.picker.cant_remove_reaction"),s?(0,u.i18n)(t,s):(0,u.i18n)(t)}static#m=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"/Eh7m4hX",block:'[[[1,"\\n"],[1,"    "],[11,0],[24,0,"discourse-reactions-reaction-button"],[16,"title",[30,0,["title"]]],[4,[32,0],["click",[30,0,["click"]]],null],[4,[32,0],["pointerover",[30,0,["pointerOver"]]],null],[4,[32,0],["pointerout",[30,0,["pointerOut"]]],null],[12],[1,"\\n"],[41,[30,1,["current_user_used_main_reaction"]],[[[1,"        "],[10,"button"],[14,0,"btn-toggle-reaction-like btn-icon no-text reaction-button"],[15,"title",[30,0,["title"]]],[14,4,"button"],[12],[1,"\\n          "],[1,[28,[32,1],[[30,0,["siteSettings","discourse_reactions_like_icon"]]],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,1,["current_user_reaction"]],[[[1,"        "],[10,"button"],[14,0,"btn-icon no-text reaction-button"],[15,"title",[30,0,["title"]]],[14,4,"button"],[12],[1,"\\n          "],[10,"img"],[14,0,"btn-toggle-reaction-emoji reaction-button"],[15,"src",[28,[32,2],[[30,1,["current_user_reaction","id"]]],null]],[15,"alt",[28,[32,3],[":",[30,1,["current_user_reaction","id"]]],null]],[12],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,"button"],[14,0,"btn-toggle-reaction-like btn-icon no-text reaction-button"],[15,"title",[30,0,["title"]]],[14,4,"button"],[12],[1,"\\n          "],[1,[28,[32,1],[[28,[32,3],["far-",[30,0,["siteSettings","discourse_reactions_like_icon"]]],null]],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]],[]]],[1,"    "],[13],[1,"\\n  "]],["@post"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-button.js",scope:()=>[i.on,c.default,a.emojiUrlFor,s.concat],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-post",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/object/computed","@ember/service","discourse/components/user-stream-item","discourse/helpers/avatar","discourse/lib/ajax","discourse/lib/get-url","discourse/lib/text","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d,p,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let m=new Map,g=null
class _ extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#c=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
static#o=(()=>dt7948.g(this.prototype,"updatedExcerpt",[s.tracked],(function(){return this.args.reaction.post.excerpt})))()
#O=(()=>{dt7948.i(this,"updatedExcerpt")})()
static#n=(()=>dt7948.g(this.prototype,"updatedExpandedExcerpt",[s.tracked],(function(){return this.args.reaction.post.expandedExcerpt})))()
#R=(()=>{dt7948.i(this,"updatedExpandedExcerpt")})()
static#a=(()=>dt7948.g(this.prototype,"moderatorAction",[(0,r.equal)("args.reaction.post.post_type","site.post_types.moderator_action")]))()
#T=(()=>{dt7948.i(this,"moderatorAction")})()
constructor(){super(...arguments),this.updateMentionedUsernames()}async updateMentionedUsernames(){this.updatedExcerpt=await this.replaceMentionsWithFullNames(this.args.reaction.post.excerpt),this.updatedExpandedExcerpt=await this.replaceMentionsWithFullNames(this.args.reaction.post.expandedExcerpt)}static#l=(()=>dt7948.n(this.prototype,"updateMentionedUsernames",[o.action]))()
async replaceMentionsWithFullNames(e){if(!e)return e
return(await Promise.all(e.split(/@([\p{L}\d._]+)/gu).map((async(e,t)=>{if(t%2==1){return`@${await this.searchUsername(e)||e}`}return e})))).join("")}async searchUsername(e){if(e=e.toLowerCase(),m.has(e))return m.get(e)
if(g?.usernames.size<=50){g.usernames.add(e)
const t=await g.search
if(t.searchedUsernames.includes(e)){const s=t.data.users?.find((t=>t.username.toLowerCase()===e))?.name||t.data.groups?.find((t=>t.name.toLowerCase()===e))?.full_name
return m.set(e,s),s}}return this.deferSearch(e)}async deferSearch(e){const t=new Set([e])
return g={search:new Promise((e=>{setTimeout((async()=>{const s=Array.from(t)
g=null
const i=await(0,u.ajax)("/u/search/users.json",{data:{usernames:s.join(","),include_groups:this.siteSettings.show_fullname_for_groups}})
e({searchedUsernames:s,data:i})}),20)})),usernames:t},this.searchUsername(e)}get postUrl(){return(0,l.default)(this.args.reaction.post.url)}get emojiUrl(){const e=this.args.reaction.reaction.reaction_value
return e?(0,d.emojiUrlFor)(e):null}static#p=(()=>(0,p.setComponentTemplate)((0,h.createTemplateFactory)({id:"Woxj4Zvq",block:'[[[1,"\\n    "],[8,[32,0],null,[["@item"],[[28,[32,1],null,[["username","name","avatar_template","created_at","postUrl","category","title","expandedExcerpt","excerpt","topic_id","post_id","user_id"],[[30,1,["post_user","username"]],[30,1,["post_user","name"]],[30,1,["post_user","avatar_template"]],[30,1,["created_at"]],[30,0,["postUrl"]],[30,1,["category"]],[30,1,["topic","title"]],[30,0,["updatedExpandedExcerpt"]],[30,0,["updatedExcerpt"]],[30,1,["topic_id"]],[30,1,["post_id"]],[30,1,["user_id"]]]]]]],[["bottom"],[[[[1,"\\n"],[41,[30,1,["reaction","reaction_users_count"]],[[[1,"          "],[10,0],[14,0,"discourse-reactions-my-reaction"],[12],[1,"\\n            "],[10,"img"],[15,"src",[30,0,["emojiUrl"]]],[14,0,"reaction-emoji"],[12],[13],[1,"\\n            "],[10,3],[15,6,[30,1,["user","userUrl"]]],[15,"data-user-card",[30,1,["user","username"]]],[14,0,"avatar-link"],[12],[1,"\\n              "],[1,[28,[32,2],[[30,1,["user"]]],[["imageSize","extraClasses","ignoreTitle"],["tiny","actor","true"]]]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n  "]],["@reaction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-post.js",scope:()=>[c.default,i.hash,a.default],isStrictMode:!0}),this))()}e.default=_})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction",["exports","@glimmer/component","@ember/modifier","@ember/object","truth-helpers","discourse/components/user-avatar","discourse/helpers/concat-class","discourse/helpers/d-icon","discourse/helpers/emoji","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{click(e){e?.target?.classList?.contains("show-users")&&(e.preventDefault(),e.stopPropagation(),this.args.showUsers(this.args.reaction.id))}static#e=(()=>dt7948.n(this.prototype,"click",[i.action]))()
get firstLineUsers(){return this.args.users.slice(0,8)}get otherUsers(){return this.args.users.slice(8,26)}get columnsCount(){return this.args.users.length>8?this.firstLineUsers.length+1:this.firstLineUsers.length}get moreLabel(){if(this.args.isDisplayed&&this.args.reaction.count>26)return(0,u.i18n)("discourse_reactions.state_panel.more_users",{count:this.args.reaction.count-26})}static#s=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"M/gaAoyo",block:'[[[1,"\\n"],[1,"    "],[11,0],[16,0,[28,[32,0],["discourse-reactions-state-panel-reaction",[52,[30,1],"is-displayed"]],null]],[4,[32,1],["click",[30,0,["click"]]],null],[12],[1,"\\n"],[41,[30,2],[[[1,"        "],[10,0],[14,0,"reaction-wrapper"],[12],[1,"\\n          "],[10,0],[14,0,"emoji-wrapper"],[12],[1,"\\n            "],[1,[28,[32,2],[[30,3,["id"]]],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,0],[14,0,"count"],[12],[1,"\\n            "],[1,[30,3,["count"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"users"],[12],[1,"\\n          "],[10,0],[15,0,[29,["list list-columns-",[30,0,["columnsCount"]]]]],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["firstLineUsers"]]],null]],null],"username",[[[1,"              "],[10,1],[12],[1,"\\n                "],[8,[32,3],[[24,0,"trigger-user-card"]],[["@size","@user"],["tiny",[30,4]]],null],[1,"\\n              "],[13],[1,"\\n"]],[4]],null],[1,"\\n"],[41,[28,[32,4],[[30,2,["length"]],[32,5]],null],[[[1,"              "],[10,"button"],[14,0,"show-users"],[14,4,"button"],[12],[1,"\\n                "],[1,[28,[32,6],[[52,[30,1],"chevron-up","chevron-down"]],null]],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["otherUsers"]]],null]],null],"username",[[[1,"                "],[10,1],[12],[1,"\\n                  "],[8,[32,3],[[24,0,"trigger-user-card"]],[["@size","@user"],["tiny",[30,5]]],null],[1,"\\n                "],[13],[1,"\\n"]],[5]],null]],[]],null],[1,"          "],[13],[1,"\\n          "],[10,1],[14,0,"more"],[12],[1,"\\n            "],[1,[30,0,["moreLabel"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@isDisplayed","@users","@reaction","user","user"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction.js",scope:()=>[n.default,s.on,a.default,r.default,o.gt,8,c.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","truth-helpers","discourse/helpers/concat-class","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel-reaction","@ember/component","@ember/template-factory"],(function(e,t,s,i,o,r,n,c,a,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"displayedReactionId",[s.tracked]))()
#M=(()=>{dt7948.i(this,"displayedReactionId")})()
get classes(){const e=[],{post:t}=this.args
if(t?.reactions){const s=Math.max(...t.reactions.mapBy("count")).toString().length
e.push(`max-length-${s}`)}return this.args.statePanelExpanded&&e.push("is-expanded"),e}pointerOut(e){"mouse"===e.pointerType&&this.args.scheduleCollapse("collapseStatePanel")}static#s=(()=>dt7948.n(this.prototype,"pointerOut",[o.action]))()
pointerOver(e){"mouse"===e.pointerType&&this.args.cancelCollapse()}static#o=(()=>dt7948.n(this.prototype,"pointerOver",[o.action]))()
showUsers(e){this.displayedReactionId?this.displayedReactionId===e?this.hideUsers():this.displayedReactionId!==e&&(this.displayedReactionId=e):this.displayedReactionId=e}static#n=(()=>dt7948.n(this.prototype,"showUsers",[o.action]))()
hideUsers(){this.displayedReactionId=null}static#a=(()=>dt7948.n(this.prototype,"hideUsers",[o.action]))()
get hasReactionData(){return!!Object.keys(this.args.reactionsUsers).length}static#l=(()=>(0,a.setComponentTemplate)((0,u.createTemplateFactory)({id:"JHM8em18",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["discourse-reactions-state-panel",[30,0,["classes"]]],null]],[4,[32,1],["pointerout",[30,0,["pointerOut"]]],null],[4,[32,1],["pointerover",[30,0,["pointerOver"]]],null],[12],[1,"\\n"],[41,[28,[32,2],[[30,1],[30,2,["reactions","length"]]],null],[[[1,"        "],[10,0],[14,0,"container"],[12],[1,"\\n"],[41,[30,0,["hasReactionData"]],[[[1,"            "],[10,0],[14,0,"counters"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,2,["reactions"]]],null]],null],"id",[[[1,"                "],[8,[32,3],null,[["@reaction","@users","@post","@isDisplayed","@showUsers"],[[30,3],[28,[32,4],[[30,4],[30,3,["id"]]],null],[30,2],[28,[32,5],[[30,3,["id"]],[30,0,["displayedReactionId"]]],null],[30,0,["showUsers"]]]],null],[1,"\\n"]],[3]],null],[1,"            "],[13],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"spinner-container"],[12],[1,"\\n              "],[10,0],[14,0,"spinner small"],[12],[13],[1,"\\n            "],[13],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@statePanelExpanded","@post","reaction","@reactionsUsers"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-state-panel.js",scope:()=>[n.default,i.on,r.and,c.default,o.get,r.eq],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/discourse-reactions/discourse/connectors/user-activity-bottom/discourse-reactions-user-activity-reactions",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/helpers/d-icon","discourse-i18n","@ember/template-factory"],(function(e,t,s,i,o,r,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=dt7948.c(class extends t.default{static#e=(()=>(0,t.setComponentTemplate)((0,n.createTemplateFactory)({id:"g/3NBaMG",block:'[[[1,"\\n"],[41,[30,0,["siteSettings","discourse_reactions_enabled"]],[[[1,"      "],[8,[32,0],null,[["@route"],["userActivity.reactions"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["far-face-smile"],null]],[1,"\\n        "],[10,1],[12],[1,[28,[32,2],["discourse_reactions.reactions_title"],null]],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/connectors/user-activity-bottom/discourse-reactions-user-activity-reactions.js",scope:()=>[s.LinkTo,o.default,r.i18n],isStrictMode:!0}),this))()},[(0,i.classNames)("user-activity-bottom-outlet","discourse-reactions-user-activity-reactions"),(0,i.tagName)("li")])
e.default=c})),define("discourse/plugins/discourse-reactions/discourse/connectors/user-notifications-bottom/discourse-reactions-user-notification-reactions",["exports","@ember/component","@ember/routing","@ember-decorators/component","discourse/helpers/d-icon","discourse-i18n","@ember/template-factory"],(function(e,t,s,i,o,r,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=dt7948.c(class extends t.default{static#e=(()=>(0,t.setComponentTemplate)((0,n.createTemplateFactory)({id:"H1DUCl2r",block:'[[[1,"\\n"],[41,[30,0,["siteSettings","discourse_reactions_enabled"]],[[[1,"      "],[8,[32,0],null,[["@route"],["userNotifications.reactionsReceived"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["far-face-smile"],null]],[1,"\\n        "],[10,1],[12],[1,[28,[32,2],["discourse_reactions.reactions_title"],null]],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/connectors/user-notifications-bottom/discourse-reactions-user-notification-reactions.js",scope:()=>[s.LinkTo,o.default,r.i18n],isStrictMode:!0}),this))()},[(0,i.classNames)("user-notifications-bottom-outlet","discourse-reactions-user-notification-reactions"),(0,i.tagName)("li")])
e.default=c})),define("discourse/plugins/discourse-reactions/discourse/controllers/user-activity-reactions",["exports","@glimmer/tracking","@ember/controller","@ember/object","@ember/service","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],(function(e,t,s,i,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[o.service]))()
#r=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"application",[s.inject]))()
#I=(()=>{dt7948.i(this,"application")})()
static#o=(()=>dt7948.g(this.prototype,"canLoadMore",[t.tracked],(function(){return!0})))()
#L=(()=>{dt7948.i(this,"canLoadMore")})()
static#n=(()=>dt7948.g(this.prototype,"loading",[t.tracked],(function(){return!1})))()
#F=(()=>{dt7948.i(this,"loading")})()
static#a=(()=>dt7948.g(this.prototype,"beforeLikeId",[t.tracked],(function(){return null})))()
#N=(()=>{dt7948.i(this,"beforeLikeId")})()
static#l=(()=>dt7948.g(this.prototype,"beforeReactionUserId",[t.tracked],(function(){return null})))()
#A=(()=>{dt7948.i(this,"beforeReactionUserId")})()
#$(e){return e.length?e[e.length-1].get("id"):null}#B(e){if(this.includeLikes){const t=this.siteSettings.discourse_reactions_reaction_for_like,[s,i]=e.reduce(((e,s)=>(s.reaction.reaction_value===t?e[0].push(s):e[1].push(s),e)),[[],[]])
this.beforeLikeId=this.#$(s),this.beforeReactionUserId=this.#$(i)}else this.beforeReactionUserId=this.#$(e)}loadMore(){if(!this.canLoadMore||this.loading)return
this.loading=!0
const e=this.model
this.beforeReactionUserId||this.#B(e)
const t={actingUsername:this.actingUsername,includeLikes:this.includeLikes,beforeLikeId:this.beforeLikeId,beforeReactionUserId:this.beforeReactionUserId}
r.default.findReactions(this.reactionsUrl,this.username,t).then((t=>{e.addObjects(t),this.#B(t),0===t.length&&(this.canLoadMore=!1)})).finally((()=>{this.loading=!1}))}static#p=(()=>dt7948.n(this.prototype,"loadMore",[i.action]))()}e.default=n})),define("discourse/plugins/discourse-reactions/discourse/discourse-reactions-user-activity-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.userActivity",map(){this.route("reactions")}}})),define("discourse/plugins/discourse-reactions/discourse/discourse-reactions-user-notifications-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.userNotifications",map(){this.route("reactionsReceived",{path:"reactions-received"})}}})),define("discourse/plugins/discourse-reactions/discourse/initializers/discourse-reactions",["exports","discourse/lib/icon-library","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/url","discourse/lib/utilities","discourse-i18n","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-button","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-actions-summary"],(function(e,t,s,i,o,r,n,c,a,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l="discourse-reactions"
function d(e){(function(e){e.registerValueTransformer("post-menu-buttons",(e=>{let{value:t,context:{buttonKeys:s}}=e
t.replace(s.LIKE,a.default),t.add("discourse-reactions-actions",u.default,{after:s.REPLIES})}))})(e),e.addKeyboardShortcut("l",null,{click:".topic-post.selected .discourse-reactions-reaction-button"}),e.modifyClass("component:scrolling-post-stream",{pluginId:l,didInsertElement(){this._super(...arguments)
const e=this?.posts?.firstObject?.topic_id
e&&this.messageBus.subscribe(`/topic/${e}/reactions`,(e=>{this.dirtyKeys.keyDirty(`discourse-reactions-counter-${e.post_id}`,{onRefresh:"reactionsChanged",refreshArg:e}),this._refresh({id:e.post_id})}))}}),e.modifyClass("controller:topic",{pluginId:l,unsubscribe(){this._super(...arguments)
const e=this.model.id
e&&this.messageBus.unsubscribe(`/topic/${e}/reactions`)}}),e.addTrackedPostProperties("current_user_used_main_reaction","reaction_users_count","current_user_reaction","reactions"),e.modifyClass("component:emoji-value-list",{pluginId:l,didReceiveAttrs(){if(this._super(...arguments),"discourse_reactions_enabled_reactions"!==this.setting.setting)return
if(this.values.includes(this.siteSettings.discourse_reactions_reaction_for_like)){const e=this.collection.findBy("value",this.siteSettings.discourse_reactions_reaction_for_like)
e&&(e.isEditable=!1)}else this.collection.unshiftObject({emojiUrl:(0,i.emojiUrlFor)(this.siteSettings.discourse_reactions_reaction_for_like),isEditable:!1,isEditing:!1,value:this.siteSettings.discourse_reactions_reaction_for_like})}},{ignoreMissing:!0}),e.replaceIcon("notification.reaction","discourse-emojis"),e.registerNotificationTypeRenderer&&e.registerNotificationTypeRenderer("reaction",(e=>class extends e{get linkTitle(){return(0,n.i18n)("notifications.titles.reaction")}get linkHref(){const e=super.linkHref
if(e)return e
let t="reactions-received"
return this.notification.data.reaction_icon&&(t="likes-received"),(0,o.userPath)(`${this.currentUser.username}/notifications/${t}?acting_username=${this.notification.data.display_username}&include_likes=true`)}get icon(){return this.notification.data.reaction_icon||`notification.${this.notificationName}`}get label(){const e=this.notification.data.count,t=this.siteSettings.prioritize_full_name_in_ux&&this.notification.data.display_name||this.username
if(!e||1===e||!this.notification.data.username2)return t
if(e>2)return(0,n.i18n)("notifications.reaction_multiple_users",{username:t,count:e-1})
{const e=this.siteSettings.prioritize_full_name_in_ux&&this.notification.data.name2||(0,r.formatUsername)(this.notification.data.username2)
return(0,n.i18n)("notifications.reaction_2_users",{username:t,username2:e})}}get labelClasses(){if(this.notification.data.username2)return this.notification.data.count>2?["multi-user"]:["double-user"]}get description(){return this.notification.data.count>1&&!this.notification.data.username2?(0,n.i18n)("notifications.reaction_1_user_multiple_posts",{count:this.notification.data.count}):super.description}}))}(0,t.replaceIcon)("notification.reaction","bell")
e.default={name:"discourse-reactions",initialize(e){e.lookup("service:site-settings").discourse_reactions_enabled&&(0,s.withPluginApi)("1.34.0",d)},teardown(){(0,c.resetCurrentReaction)()}}})),define("discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction",["exports","@ember/object","discourse/lib/ajax","discourse/models/category","discourse/models/post","discourse/models/rest","discourse/models/topic","discourse/models/user"],(function(e,t,s,i,o,r,n,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends r.default{static toggle(e,t){return(0,s.ajax)(`/discourse-reactions/posts/${e.id}/custom-reactions/${t}/toggle.json`,{type:"PUT"}).then((t=>{e.appEvents.trigger("discourse-reactions:reaction-toggled",{post:t,reaction:t.current_user_reaction})}))}static findReactions(e,r,a){const u={username:r}
return(a=a||{}).beforeReactionUserId&&(u.before_reaction_user_id=a.beforeReactionUserId),a.beforeLikeId&&(u.before_like_id=a.beforeLikeId),a.includeLikes&&(u.include_likes=a.includeLikes),a.actingUsername&&(u.acting_username=a.actingUsername),(0,s.ajax)(`/discourse-reactions/posts/${e}.json`,{data:u}).then((e=>e.map((e=>{e.user=c.default.create(e.user),e.topic=n.default.create(e.post.topic),e.post_user=c.default.create(e.post.user),e.category=i.default.findById(e.post.category_id)
const s={...e.post}
return delete s.url,e.post=o.default.create(s),t.default.create(e)}))))}static findReactionUsers(e,t){const i={}
return(t=t||{}).reactionValue&&(i.reaction_value=t.reactionValue),(0,s.ajax)(`/discourse-reactions/posts/${e}/reactions-users.json`,{data:i})}init(){super.init(...arguments),this.__type="discourse-reactions-custom-reaction"}}e.default=a})),define("discourse/plugins/discourse-reactions/discourse/routes/user-activity-reactions",["exports","discourse/routes/discourse","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{model(){return s.default.findReactions("reactions",this.modelFor("user").get("username"))}setupController(e,t){let s=t.length<20
this.controllerFor("user-activity-reactions").setProperties({model:t,canLoadMore:!s,reactionsUrl:"reactions",username:this.modelFor("user").get("username")})}}e.default=i})),define("discourse/plugins/discourse-reactions/discourse/routes/user-notifications-reactions-received",["exports","discourse/routes/discourse","discourse/plugins/discourse-reactions/discourse/models/discourse-reactions-custom-reaction"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{templateName="user-activity-reactions"
controllerName="user-activity-reactions"
queryParams={acting_username:{refreshModel:!0},include_likes:{refreshModel:!0}}
model(e){return s.default.findReactions("reactions-received",this.modelFor("user").get("username"),{actingUsername:e.acting_username,includeLikes:e.include_likes})}setupController(e,t){let s=t.length<20
this.controllerFor("user-activity-reactions").setProperties({model:t,canLoadMore:!s,reactionsUrl:"reactions-received",username:this.modelFor("user").get("username"),actingUsername:e.acting_username,includeLikes:e.include_likes}),this.controllerFor("application").set("showFooter",s)}}e.default=i})),define("discourse/plugins/discourse-reactions/discourse/templates/user-activity-reactions",["exports","ember-route-template","discourse/components/conditional-loading-spinner","discourse/components/load-more","discourse-i18n","discourse/plugins/discourse-reactions/discourse/components/discourse-reactions-reaction-post","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,i,o,r,n,c,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.default)((0,n.setComponentTemplate)((0,c.createTemplateFactory)({id:"Y3hVByGn",block:'[[[1,"\\n    "],[8,[32,0],null,[["@selector","@action"],[".user-stream-item",[30,1,["loadMore"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"user-stream"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,2]],null]],null],null,[[[1,"          "],[8,[32,1],null,[["@reaction"],[[30,3]]],null],[1,"\\n"]],[3]],[[[1,"          "],[10,0],[14,0,"alert alert-info"],[12],[1,[28,[32,2],["notifications.empty"],null]],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[8,[32,3],null,[["@condition"],[[30,1,["loading"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["@controller","@model","reaction"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/discourse-reactions/discourse/templates/user-activity-reactions.js",scope:()=>[i.default,r.default,o.i18n,s.default],isStrictMode:!0}),(0,a.default)(void 0,void 0)))}))

//# sourceMappingURL=discourse-reactions-04db89be.map